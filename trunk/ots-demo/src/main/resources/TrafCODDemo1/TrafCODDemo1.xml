<?xml version="1.0" encoding="UTF-8" ?>
<OTS xmlns="http://www.opentrafficsim.org/ots" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.opentrafficsim.org/ots https://opentrafficsim.org/docs/xsd/1.02.01/ots.xsd"
  xmlns:xi="http://www.w3.org/2001/XInclude">

  <DEFINITIONS>
    <xi:include href="https://opentrafficsim.org/docs/xsd/1.02.01/defaults/default_gtutypes.xml" />
    <xi:include href="https://opentrafficsim.org/docs/xsd/1.02.01/defaults/default_linktypes.xml" />
    <xi:include href="https://opentrafficsim.org/docs/xsd/1.02.01/defaults/default_lanetypes.xml" />

    <GTUTEMPLATES>
      <GTUTEMPLATE DEFAULT="true" GTUTYPE="CAR" ID="CAR">
        <LENGTHDIST LENGTHUNIT="m">
          <UNIFORM MIN="3.0" MAX="4.0" />
        </LENGTHDIST>
        <WIDTHDIST LENGTHUNIT="m">
          <UNIFORM MIN="1.7" MAX="2.0" />
        </WIDTHDIST>
        <MAXSPEEDDIST SPEEDUNIT="km/h">
          <CONSTANT C="120" />
        </MAXSPEEDDIST>
      </GTUTEMPLATE>
      <GTUTEMPLATE DEFAULT="true" GTUTYPE="TRUCK" ID="TRUCK">
        <LENGTHDIST LENGTHUNIT="m">
          <UNIFORM MIN="16.0" MAX="24.0" />
        </LENGTHDIST>
        <WIDTHDIST LENGTHUNIT="m">
          <UNIFORM MIN="2.2" MAX="2.7" />
        </WIDTHDIST>
        <MAXSPEEDDIST SPEEDUNIT="km/h">
          <CONSTANT C="100" />
        </MAXSPEEDDIST>
      </GTUTEMPLATE>
    </GTUTEMPLATES>

    <LINKTYPES>
      <LINKTYPE ID="STREET">
        <COMPATIBILITY GTUTYPE="VEHICLE" DIRECTION="FORWARD" />
        <SPEEDLIMIT GTUTYPE="CAR" LEGALSPEEDLIMIT="40km/h" />
        <SPEEDLIMIT GTUTYPE="TRUCK" LEGALSPEEDLIMIT="40km/h" />
      </LINKTYPE>
    </LINKTYPES>

    <ROADLAYOUTS>
      <ROADLAYOUT ID="r1" LINKTYPE="STREET">
        <SHOULDER>
          <CENTEROFFSET>-2.85m</CENTEROFFSET>
          <WIDTH>2m</WIDTH>
        </SHOULDER>
        <STRIPE TYPE="SOLID">
          <CENTEROFFSET>-1.85m</CENTEROFFSET>
        </STRIPE>
        <LANE ID="FORWARD" DESIGNDIRECTION="true" LANETYPE="URBAN_ROAD">
          <CENTEROFFSET>0.0m</CENTEROFFSET>
          <WIDTH>3.5m</WIDTH>
        </LANE>
        <STRIPE TYPE="SOLID">
          <CENTEROFFSET>1.85m</CENTEROFFSET>
        </STRIPE>
        <SHOULDER>
          <CENTEROFFSET>2.85m</CENTEROFFSET>
          <WIDTH>2m</WIDTH>
        </SHOULDER>
      </ROADLAYOUT>
    </ROADLAYOUTS>
  </DEFINITIONS>

  <NETWORK>
    <NODE ID="N" COORDINATE="(0,300)" DIRECTION="270 deg" />
    <NODE ID="E" COORDINATE="(100,0)" DIRECTION="180 deg" />
    <NODE ID="S" COORDINATE="(0,-100)" DIRECTION="90 deg" />
    <NODE ID="W" COORDINATE="(-300,0)" DIRECTION="0 deg" />
    <NODE ID="X" COORDINATE="(0,0)" DIRECTION="0 deg" />

    <LINK ID="NX" NODESTART="N" NODEEND="X" TYPE="STREET">
      <STRAIGHT />
      <DEFINEDLAYOUT>r1</DEFINEDLAYOUT>
    </LINK>

    <LINK ID="WX" NODESTART="W" NODEEND="X" TYPE="STREET">
      <STRAIGHT />
      <DEFINEDLAYOUT>r1</DEFINEDLAYOUT>
    </LINK>

    <LINK ID="XS" NODESTART="X" NODEEND="S" TYPE="STREET">
      <STRAIGHT />
      <DEFINEDLAYOUT>r1</DEFINEDLAYOUT>
    </LINK>

    <LINK ID="XE" NODESTART="X" NODEEND="E" TYPE="STREET">
      <STRAIGHT />
      <DEFINEDLAYOUT>r1</DEFINEDLAYOUT>
    </LINK>

  </NETWORK>

  <NETWORKDEMAND>

    <ROUTE ID="NS" GTUTYPE="VEHICLE">
      <NODE ID="N" />
      <NODE ID="X" />
      <NODE ID="S" />
    </ROUTE>
    
    <ROUTE ID="WE" GTUTYPE="VEHICLE">
      <NODE ID="W" />
      <NODE ID="X" />
      <NODE ID="E" />
    </ROUTE>

    <!-- TODO: GTUTEMPLATEMIX is not parsed yet -->
        
    <GTUTEMPLATEMIX ID="C60T40">
      <GTUTEMPLATE ID="CAR" WEIGHT="60" />
      <GTUTEMPLATE ID="TRUCK" WEIGHT="40" />
    </GTUTEMPLATEMIX>

    <GTUTEMPLATEMIX ID="C80T20">
      <GTUTEMPLATE ID="CAR" WEIGHT="80" />
      <GTUTEMPLATE ID="TRUCK" WEIGHT="20" />
    </GTUTEMPLATEMIX>

    <GENERATOR LINK="NX" LANE="FORWARD" POSITION="10m" DIRECTION="DIR_PLUS">
      <GTUTEMPLATE>CAR</GTUTEMPLATE>
      <ROUTE>NS</ROUTE>
      <FREQUENCY>8/min</FREQUENCY>
      <ROOMCHECKER>CF</ROOMCHECKER>
    </GENERATOR>
    <GENERATOR LINK="WX" LANE="FORWARD" POSITION="10m" DIRECTION="DIR_PLUS">
      <GTUTEMPLATE>CAR</GTUTEMPLATE>
      <ROUTE>WE</ROUTE>
      <FREQUENCY>8/min</FREQUENCY>
      <ROOMCHECKER>CF</ROOMCHECKER>
    </GENERATOR>

    <SINK LINK="XS" LANE="FORWARD" POSITION="50m" DIRECTION="DIR_PLUS" />
    <SINK LINK="XE" LANE="FORWARD" POSITION="50m" DIRECTION="DIR_PLUS" />

  </NETWORKDEMAND>

  <SCENARIO></SCENARIO>

  <RUN>
    <RUNLENGTH>1h</RUNLENGTH>
    <RANDOMSTREAMS>
      <RANDOMSTREAM ID="default">
        <REPLICATION ID="1" SEED="1" />
      </RANDOMSTREAM>
      <RANDOMSTREAM ID="generation">
        <REPLICATION ID="1" SEED="1" />
      </RANDOMSTREAM>
    </RANDOMSTREAMS>
  </RUN>

  <ANIMATION>
    <DEFAULTS>
      <SHOULDER COLOR="GREEN" />
    </DEFAULTS>
  </ANIMATION>
</OTS>