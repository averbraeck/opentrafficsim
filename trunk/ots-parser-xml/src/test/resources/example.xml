<?xml version="1.0" encoding="UTF-8" ?>
<OTS xmlns="http://www.opentrafficsim.org/ots" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.opentrafficsim.org/ots https://opentrafficsim.org/docs/xsd/1.01.02/ots.xsd"
  xmlns:xi="http://www.w3.org/2001/XInclude">

  <DEFINITIONS>

    <xi:include href="xsd/1.01.02/defaults/default_gtutypes.xml">
      <xi:fallback>
        <xi:include href="https://opentrafficsim.org/docs/xsd/1.01.02/defaults/default_gtutypes.xml" />
      </xi:fallback>
    </xi:include>

    <GTUTYPES>
      <GTUTYPE ID="AUTOMATED_CAR" PARENT="VEHICLE" />
    </GTUTYPES>

    <xi:include href="xsd/1.01.02/defaults/default_linktypes.xml">
      <xi:fallback>
        <xi:include href="https://opentrafficsim.org/docs/xsd/1.01.02/defaults/default_linktypes.xml" />
      </xi:fallback>
    </xi:include>

    <LINKTYPES>
      <LINKTYPE ID="HIGHWAY2x2" DEFAULT="false" PARENT="HIGHWAY">
        <COMPATIBILITY GTUTYPE="VEHICLE" DIRECTION="BOTH" />
        <COMPATIBILITY GTUTYPE="AUTOMATED_CAR" DIRECTION="BOTH" />
        <COMPATIBILITY GTUTYPE="PEDESTRIAN" DIRECTION="NONE" />
        <COMPATIBILITY GTUTYPE="BICYCLE" DIRECTION="NONE" />
      </LINKTYPE>
    </LINKTYPES>

    <xi:include href="xsd/1.01.02/defaults/default_lanetypes.xml">
      <xi:fallback>
        <xi:include href="https://opentrafficsim.org/docs/xsd/1.01.02/defaults/default_lanetypes.xml" />
      </xi:fallback>
    </xi:include>

    <LANETYPES>
      <LANETYPE ID="HIGHWAYLANE2x2" DEFAULT="false" PARENT="HIGHWAY">
        <COMPATIBILITY GTUTYPE="VEHICLE" DIRECTION="FORWARD" />
        <COMPATIBILITY GTUTYPE="AUTOMATED_CAR" DIRECTION="FORWARD" />
        <COMPATIBILITY GTUTYPE="PEDESTRIAN" DIRECTION="NONE" />
        <COMPATIBILITY GTUTYPE="BICYCLE" DIRECTION="NONE" />
      </LANETYPE>
    </LANETYPES>

    <xi:include href="xsd/1.01.02/defaults/default_gtutemplates.xml">
      <xi:fallback>
        <xi:include href="https://opentrafficsim.org/docs/xsd/1.01.02/defaults/default_gtutemplates.xml" />
      </xi:fallback>
    </xi:include>

    <GTUTEMPLATES>
      <GTUTEMPLATE ID="AUTOCAR" GTUTYPE="AUTOMATED_CAR">
        <LENGTHDIST LENGTHUNIT="m">
          <UNIFORM MIN="4" MAX="5" />
        </LENGTHDIST>
        <WIDTHDIST LENGTHUNIT="m">
          <TRIANGULAR MIN="1.5" MODE="1.6" MAX="1.7" />
        </WIDTHDIST>
        <MAXSPEEDDIST SPEEDUNIT="km/h">
          <UNIFORM MIN="90" MAX="110" />
        </MAXSPEEDDIST>
      </GTUTEMPLATE>
    </GTUTEMPLATES>

    <!--
    _______________ -6m
    shoulder center -5m
    _______________ -4m
    lane center L1  -3m  <== driving direction
    - - - - - - - - -2m
    lane center L2  -1m  <== driving direction
    ===============  0m
    lane center R2  +1m  ==> driving direction
    - - - - - - - - +2m
    lane center R1  +3m  ==> driving direction
    _______________ +4m
    shoulder center +5m
    _______________ +6m
    -->

    <ROADLAYOUTS>
      <ROADLAYOUT LINKTYPE="HIGHWAY2x2" ID="HW22">
        <STRIPE TYPE="SOLID" />
        <SHOULDER>
          <WIDTH>2m</WIDTH>
        </SHOULDER>
        <STRIPE TYPE="SOLID" />
        <LANE ID="L1" DESIGNDIRECTION="false" LANETYPE="HIGHWAYLANE2x2">
          <WIDTH>2m</WIDTH>
        </LANE>
        <STRIPE TYPE="DASHED" />
        <LANE ID="L2" DESIGNDIRECTION="false" LANETYPE="HIGHWAYLANE2x2">
          <WIDTH>2m</WIDTH>
        </LANE>
        <STRIPE TYPE="DOUBLE">
          <CENTEROFFSET>0m</CENTEROFFSET>
        </STRIPE>
        <LANE ID="R2" DESIGNDIRECTION="true" LANETYPE="HIGHWAYLANE2x2">
          <WIDTH>2m</WIDTH>
        </LANE>
        <STRIPE TYPE="DASHED" />
        <LANE ID="R1" DESIGNDIRECTION="true" LANETYPE="HIGHWAYLANE2x2">
          <WIDTH>2m</WIDTH>
        </LANE>
        <STRIPE TYPE="SOLID" />
        <SHOULDER>
          <WIDTH>2m</WIDTH>
        </SHOULDER>
        <STRIPE TYPE="SOLID" />
      </ROADLAYOUT>
    </ROADLAYOUTS>

  </DEFINITIONS>

  <NETWORK>

    <NODE COORDINATE="(0,0)" ID="N1" />
    <NODE COORDINATE="(100,0)" ID="N2" />
    <NODE COORDINATE="(300,100)" ID="N3" />
    <NODE COORDINATE="(400,100)" ID="N4" />

    <LINK NODESTART="N1" NODEEND="N2" ID="L12">
      <STRAIGHT />
      <DEFINEDLAYOUT>HW22</DEFINEDLAYOUT>
    </LINK>

    <LINK NODESTART="N2" NODEEND="N3" ID="L23">
      <BEZIER NUMSEGMENTS="128" />
      <DEFINEDLAYOUT>HW22</DEFINEDLAYOUT>
    </LINK>

    <LINK NODESTART="N3" NODEEND="N4" ID="L34">
      <STRAIGHT />
      <DEFINEDLAYOUT>HW22</DEFINEDLAYOUT>
    </LINK>

    <ROUTE ID="A">
      <NODE>N1</NODE>
      <NODE>N2</NODE>
      <NODE>N3</NODE>
      <NODE>N4</NODE>
    </ROUTE>

  </NETWORK>

  <NETWORKDEMAND>
    <GENERATOR LINK="L12" DIRECTION="DIR_PLUS" LANE="R1" POSITION="10m">
      <GTU>CAR</GTU>
      <ROUTE>A</ROUTE>
      <IAT DURATIONUNIT="s">
        <EXPONENTIAL LAMBDA="10" />
      </IAT>
      <ROOMCHECKER>CF</ROOMCHECKER>
    </GENERATOR>
    <GENERATOR LINK="L12" DIRECTION="DIR_PLUS" LANE="R2" POSITION="10m">
      <GTU>CAR</GTU>
      <ROUTE>A</ROUTE>
      <IAT DURATIONUNIT="s">
        <EXPONENTIAL LAMBDA="10" />
      </IAT>
      <ROOMCHECKER>CF</ROOMCHECKER>
    </GENERATOR>
  </NETWORKDEMAND>

  <CONTROL>
    <FIXEDTIME ID="FT" CYCLETIME="90s">
      <SIGNALGROUP ID="S1" GREEN="10s" YELLOW="5s" OFFSET="0s">
        <TRAFFICLIGHT LINK="L1" TRAFFICLIGHTID="061" />
        <TRAFFICLIGHT LINK="L2" TRAFFICLIGHTID="062" />
      </SIGNALGROUP>
      <SIGNALGROUP ID="S2" GREEN="10s" YELLOW="5s" OFFSET="15s">
        <TRAFFICLIGHT LINK="L3" TRAFFICLIGHTID="002"/>
      </SIGNALGROUP>
    </FIXEDTIME>
  </CONTROL>

  <RUN>
    <RUNLENGTH>1h</RUNLENGTH>
  </RUN>

</OTS>
